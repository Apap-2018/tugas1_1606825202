<!DOCTYPE html>
<html>

<head>
	<title>Tambah Pegawai</title>
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
	
</head>

<body>
	<div th:insert="~{header :: header}"></div>
	<h2>Tambah Pegawai</h2>
	
	<form th:action="@{/pegawai/tambah}" th:object="${pegawai}" method="POST">
		<div class="form-group">
		  <label>Nama:</label>
		  <input class="form-control" type="text" name="nama" />
		</div>
		
		<div class="form-group">
			<input type="hidden" name="nip" />
		</div>
		
		<div class="form-group">
		  <label>Tempat Lahir:</label>
		  <input class="form-control" type="text" name="tempatLahir" />
		</div>
				
		<div class="form-group">
		  <label>Tanggal Lahir:</label>
		  <input class="form-control" type="date" name="tanggalLahir" />
		</div>
		
		<div class="form-group">
		  <label>Tahun Masuk:</label>		
		  <select class="form-control" type="text" name="tahunMasuk" id="tahunMasuk"></select>  
		</div>
		
		<div class="form-group">
		  <label>Provinsi:</label>
		  <select class="form-control" name="provinsi" id="provinsi">
		  	<option disabled="disabled" selected="selected" >-- Pilih Provinsi --</option>
		    <option th:each="provinsi: ${listProvinsi}" 
		    		th:value="${provinsi.id}" 
		    		th:text="${provinsi.nama}"></option>
		  </select>
		</div>
		
		<div class="form-group">
		  <label>Instansi:</label>
		  <select class="form-control"
		  		  name="instansi"
		  		  id="instansi"
		  		  th:value="${instansi}"
		  		  required="required">
		  	<option disabled="disabled" selected="selected" >-- Pilih Provinsi --</option>		  
		  </select>
		</div>
		 
		<div class="form-group">
		<label>Jabatan</label>
		  <select multiple class="form-control" name="jabatan" id="jabatan">
		    <option th:each="jabatan: ${listJabatan}"
		    		th:value="${jabatan.id}" 
		    		th:text="${jabatan.nama}"></option>
		  </select>
		  <p style="font-size:10px;color:grey;">dapat memilih beberapa jabatan</p>
		</div>
		 
		<button type="submit">Submit</button>	 
	
	</form>
	
	<script>
		$('#provinsi').change(
			function() {
	            $.getJSON("http://localhost:8080/provinsi/instansi", {
	                provinsiId : $(this).val(),
	                ajax : 'true'
	            }, function(data) {
	                var html = '<option disabled="disabled" selected="selected">-- Pilih Instansi --</option>';
	                var len = data.length;
	                for ( var i = 0; i < len; i++) {
	                    html += 
	                    	'<option value= "'+ data[i].id +'" + th:text="'+ data[i].nama +'">' + data[i].nama + '</option>';
	                }
	                $('#instansi').html(html);
	            });
	        });
		
		$('#instansi').change(
			function(){
				$.getJSON("http://localhost:8080/get/instansi", {
	                instansiId : $(this).val(),
	                ajax : 'true'
	            },
	            function(data) {
	                this.value = data;
	            });
			});
		
		$('#jabatan').change(
			function(){
				$.getJSON("http://localhost:8080/get/list-jabatan", {
	                listOfJabatanId : $(this).val(),
	                ajax : 'true'
	            },
	            function(data) {
	                this.value = data;
	            });
			});
		
		for(var i=1945; i<=2018; i++){
		    var select = document.getElementById("tahunMasuk");
		    var option = document.createElement("OPTION");
		    select.options.add(option);
		    option.text = i;
		    option.value = i;
		}
		
		
		
	</script>
	
</body>

</html>